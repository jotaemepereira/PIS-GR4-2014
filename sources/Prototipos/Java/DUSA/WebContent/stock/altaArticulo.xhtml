<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

<f:view contentType="text/html">
	<h:head>
		<link href="../CSS/General.css" rel="stylesheet" />
		<link href="../CSS/bootstrap-theme.min.css" rel="stylesheet" />
		<link href="../CSS/font-awesome.min.css" rel="stylesheet" />
		<script src="../JS/bootstrap.min.js"></script>		
		<f:facet name="first">
			<meta content='text/html; charset=UTF-8' http-equiv="Content-Type" />
			<title>DUSA</title>
		</f:facet>
		<script src="../JS/altaArticulo.js"></script>
	</h:head>
	<h:body>
		<link href="../CSS/bootstrap.min.css" rel="stylesheet" />
		<h:form id="form1">
			<ui:include src="../cabezal.xhtml" />
			<ui:include src="../menuVertical/stock.xhtml" />

			<div class="vpanel_right">
				<div class="wrapper">				
					<div class="panel panel-default" id="panel">
						<div class="panel-heading">
							<h3 class="panel-title">Alta de artículo</h3>
						</div>
						<p:messages id="msgs" />					
						<div class="panel-body">
							<h:panelGroup layout="block" id="panel">
							<div class="container-fluid">
								<div class="row" style="margin-bottom: 1%;">
									<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
										<p:outputLabel for="descripcion" value="Descripción:" />
										<p:inputText id="descripcion" styleClass="form-control" value="#{stockBean.articulo.descripcion}" size="60" requiredMessage="Dato Requerido." style="height: 100%"
										required="true" />
										<p:message for="descripcion" />
									</div>
									<div class="col-xs-12 col-sm-12 col-md-2 col-lg-2">
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:outputLabel for="tipoArticulo" value="Tipo de Artículo:" />
											</div>
										</div>
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:selectOneMenu id="tipoArticulo" value="#{stockBean.articulo.tipoArticulo}" required="true" requiredMessage="Dato Requerido." >
										            <f:selectItem itemLabel="Seleccione tipo de artículo" itemValue="#{null}" noSelectionOption="true" />
										            <f:selectItems value="#{stockBean.tiposArticulo}" var="ta" itemLabel="#{ta.descripcion}" itemValue="#{ta.tipoArticulo}"/>
										        </p:selectOneMenu>
										        <p:message for="tipoArticulo" />
											</div>
										</div>
									</div>
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:outputLabel for="codigoBarras" value="Código de barras:" />
											</div>
										</div>
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:inputText id="codigoBarras" value="#{stockBean.articulo.codigoBarras}" styleClass="form-control"/>
											</div>
										</div>		
									</div>
								</div>
								<div class="row" style="margin-bottom: 1%;">
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:outputLabel for="clave1" value="Clave de búsqueda 1:" />
												<span data-toggle="tooltip" title="Clave que se usa para optimizar las búsquedas" 
														class="glyphicon glyphicon-question-sign"></span>												
											</div>
										</div>
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:inputText id="clave1" value="#{stockBean.articulo.clave1}" styleClass="form-control"/>												
											</div>
										</div>		
									</div>
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:outputLabel for="clave2" value="Clave de búsqueda 2:" />
												<span data-toggle="tooltip" title="Clave que se usa para optimizar las búsquedas" 
														class="glyphicon glyphicon-question-sign"></span>
											</div>
										</div>
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:inputText id="clave2" value="#{stockBean.articulo.clave2}" styleClass="form-control"/>
											</div>
										</div>		
									</div>
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:outputLabel for="clave3" value="Clave de búsqueda 3:" />
												<span data-toggle="tooltip" title="Clave que se usa para optimizar las búsquedas" 
														class="glyphicon glyphicon-question-sign"></span>
											</div>
										</div>
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:inputText id="clave3" value="#{stockBean.articulo.clave3}" styleClass="form-control"/>
											</div>
										</div>		
									</div>
								</div>
								<div class="panel panel-default" id="panel">
									<div class="panel-heading">
										<h3 class="panel-title">Proveedores: *</h3>
									</div>
									<div class="panel-body">
										<div class="row" style="margin-bottom: 1%;">
											<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
												<div class="row">
													<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
														<p:outputLabel for="proveedor" value="Proveedor:" />
													</div>
												</div>
												<div class="row">
													<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
														<p:selectOneMenu id="proveedor" value="#{stockBean.proveedor}"
												        			filter="true" filterMatchMode="contains" required="false" >
												            <f:selectItem itemLabel="Seleccione proveedor" itemValue="" />
												            <f:selectItems value="#{stockBean.listaProveedores}" var="p" itemLabel="#{p.nombreComercial}" itemValue="#{p.idProveedor}"/>
												        	<f:ajax event="change" execute="@this" />
												        </p:selectOneMenu>
											        </div>
										        </div>
											</div>
											<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
												<div class="row">
													<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
														<p:outputLabel for="codigoIdentificador" value="Código identificador:" />
														<span data-toggle="tooltip" title="Código único del artículo para el proveedor seleccionado." 
														class="glyphicon glyphicon-question-sign"></span>
													</div>
												</div>
												<div class="row">
													<div class="col-xs-10 col-sm-10 col-md-10 col-lg-10">
														<p:inputText id="codigoIdentificador" styleClass="form-control" value="#{stockBean.codigoIdentificador}" style="height: 100%"
														required="false" />
													</div>
													<div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
														<p:commandButton value="Agregar" update="msgs tablaProveedores" actionListener="#{stockBean.agregarProveedor}" 
														styleClass="btn btn-info pull-right" process="@this,codigoIdentificador"/>
													</div>
												</div>
											</div>
										</div>
										
										<div class="row" style="margin-bottom: 1%;">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:dataTable id="tablaProveedores" var="proveedor" value="#{stockBean.proveedoresSeleccionados}" emptyMessage="No hay ningún proveedor asociado a este artículo.">
												    <p:column headerText="Nombre comercial">
												        <h:outputText value="#{proveedor.nombreComercial}" />
												    </p:column>
												 
												    <p:column headerText="Código identificador">
												        <h:outputText value="#{proveedor.codigoIdentificador}" />
												    </p:column>
												 </p:dataTable>
											 </div>
										</div>
									</div>
								</div>
								<div class="row" style="margin-bottom: 1%;">
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<p:outputLabel for="presentaciones" value="Presentaciones:" />
										<p:selectManyMenu id="presentaciones" value="#{stockBean.articulo.presentaciones}" required="false" 
					                          var="p" filter="true" filterMatchMode="contains" showCheckbox="true" style="height: 100%; width: 100%">
								            <f:selectItems value="#{stockBean.presentaciones}" var="presentacion" itemLabel="#{presentacion.descripcion}" itemValue="#{presentacion.idPresentacion}" />
								 
								            <p:column>
								                <h:outputText value="#{p.descripcion}" />
								            </p:column>
							        	</p:selectManyMenu>
									</div>
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
					       				<p:outputLabel for="drogas" value="Drogas:" />
					       				<p:selectManyMenu id="drogas" value="#{stockBean.articulo.drogas}" required="false"
					                          var="d" filter="true" filterMatchMode="contains" showCheckbox="true" style="height: 100%; width: 100%">
								            <f:selectItems value="#{stockBean.drogas}" var="droga" itemLabel="#{droga.descripcion}" itemValue="#{droga.idDroga}" />
								 
								            <p:column>
								                <h:outputText value="#{d.descripcion}" />
								            </p:column>
							        	</p:selectManyMenu>
									</div>
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
						       			<p:outputLabel for="accionesTer" value="Acciones Terapéuticas:" />
						       			<p:selectManyMenu id="accionesTer" value="#{stockBean.articulo.accionesTer}" required="false"
						                          var="a" filter="true" filterMatchMode="contains" showCheckbox="true" style="height: 100%; width: 100%">
								            <f:selectItems value="#{stockBean.accionesTer}" var="accionTer" itemLabel="#{accionTer.descripcion}" itemValue="#{accionTer.idAccionTer}" />
								 
								            <p:column>
								                <h:outputText value="#{a.descripcion}" />
								            </p:column>
								        </p:selectManyMenu>
									</div>
								</div>
								
								<div class="row" style="margin-bottom: 1%;">
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:outputLabel for="psicofarmaco" value="Es psicofármaco:" />
											</div>
										</div>
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:selectBooleanCheckbox id="psicofarmaco" value="#{stockBean.articulo.esPsicofarmaco}" />
											</div>
										</div>							
									</div>
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:outputLabel for="estupefaciente" value="Es estupefaciente:" />
											</div>
										</div>
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:selectBooleanCheckbox id="estupefaciente" value="#{stockBean.articulo.esEstupefaciente}" />
											</div>
										</div>
									</div>
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:outputLabel for="heladera" value="Es de heladera:" />												
											</div>
										</div>
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:selectBooleanCheckbox id="heladera" value="#{stockBean.articulo.esHeladera}" />												
										    </div>
										</div>
									</div>
								</div>
								
								<div class="row" style="margin-bottom: 1%;">
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<p:outputLabel for="costoLista" value="Costo de lista ($):" />
										<p:inputText id="costoLista" styleClass="form-control" value="#{stockBean.articulo.costoLista}" converterMessage="Dato Inválido." requiredMessage="Dato Requerido." style="height: 100%"
										required="true" >
						                	<f:convertNumber type="number"/>
						            	</p:inputText>
						            	<p:message for="costoLista" />
									</div>
<!-- 									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4"> -->
<!-- 										<p:outputLabel for="costoReal" value="Costo real ($):" /> -->
<!-- 										<p:inputText id="costoReal" styleClass="form-control" value="#{stockBean.articulo.ultimoCosto}" converterMessage="Dato Inválido." requiredMessage="Dato Requerido." style="height: 100%" -->
<!-- 										required="true" > -->
<!-- 						                	<f:convertNumber type="number"/> -->
<!-- 						            	</p:inputText> -->
<!-- 						            	<p:message for="costoReal" /> -->
<!-- 									</div> -->
								</div>
								
								<div class="row" style="margin-bottom: 1%;">
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<p:outputLabel for="precioPublico" value="Precio público ($):" />
										<p:inputText id="precioPublico" styleClass="form-control" value="#{stockBean.articulo.precioUnitario}" converterMessage="Dato Inválido." requiredMessage="Dato Requerido." style="height: 100%"
										required="true" >
						                	<f:convertNumber type="number"/>
						            	</p:inputText>
						            	<p:message for="precioPublico" />
									</div>
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<p:outputLabel for="precioVenta" value="Precio de venta ($):" />
										<p:inputText id="precioVenta" styleClass="form-control" value="#{stockBean.articulo.precioVenta}" converterMessage="Dato Inválido." style="height: 100%" >
						                	<f:convertNumber type="number"/>
						            	</p:inputText>
						            	<p:message for="precioVenta" />
									</div>
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<p:outputLabel for="porcentajePrecioVenta" value="Precio de venta (%):" />
										<p:inputText id="porcentajePrecioVenta" styleClass="form-control" value="#{stockBean.articulo.porcentajePrecioVenta}" converterMessage="Dato Inválido." style="height: 100%" >
						                	<f:convertNumber type="number"/>
						            	</p:inputText>
						            	<p:message for="porcentajePrecioVenta" />
									</div>
								</div>
								
								<div class="row" style="margin-bottom: 1%;">
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:outputLabel for="formaVenta" value="Forma de venta:" />
											</div>
										</div>
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:selectOneMenu id="formaVenta" value="#{stockBean.articulo.codigoVenta}" required="false" >
										            <f:selectItem itemLabel="Seleccione forma de venta" itemValue="-1" />
										            <f:selectItems value="#{stockBean.formasVenta}" var="f" itemLabel="#{f.descripcion}" itemValue="#{f.formaVenta}"/>
										        </p:selectOneMenu>
										    </div>
										</div>
									</div>
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:outputLabel for="tipoIVA" value="Tipo de IVA:" />
											</div>
										</div>
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:selectOneMenu id="tipoIVA" value="#{stockBean.articulo.tipoIva}" style="height: 100%" required="false" >
										            <f:selectItem itemLabel="Seleccione tipo de IVA" itemValue="-1" />
										            <f:selectItems value="#{stockBean.tiposIVA}" />
										        </p:selectOneMenu>
										    </div>
										</div>
									</div>
									<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:outputLabel for="stockMinimo" value="Stock Mínimo:" />
											</div>
										</div>
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p:inputText id="stockMinimo" styleClass="form-control" value="#{stockBean.articulo.stockMinimo}" converterMessage="Dato Inválido." >
								                	<f:convertNumber type="number"/>
								            	</p:inputText>
										    </div>
										</div>
									</div>
								</div>
	
								<div class="row" style="margin-bottom: 1%;">
									<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<div class="btn-group pull-right">									
											<p:commandButton value="Confirmar" update="panel msgs" actionListener="#{stockBean.altaArticulo}" styleClass="btn btn-success" />
											<p:commandButton value="Cancelar"  update="panel" actionListener="#{stockBean.cancelarAltaArticulo}" styleClass="btn btn-default" type="reset" />
										</div>
									</div>								
								</div>
							</div>
							</h:panelGroup>
						</div>
					</div>
				</div>
			</div>
			<p:ajaxStatus
				style="width:64px;height:64px;position:fixed;right:5px;bottom:5px"
				id="ajaxStatusPanel0">
				<f:facet name="start">
					<h:graphicImage value="../Images/ajax_loading_big.gif" />
				</f:facet>

				<f:facet name="complete">
					<h:outputText value="" />
				</f:facet>
			</p:ajaxStatus>
		</h:form>
	</h:body>
</f:view>
</html>